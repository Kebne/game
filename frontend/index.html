<!DOCTYPE html>
<html>
<head>
    <title>The game</title>
    <meta charset="UTF-8">
    <meta lang="se-SV">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Slab&display=swap" rel="stylesheet">
    <link href="main.css" rel="stylesheet">
</head>

<body id="kebne-game">
  
  <main>
    <section>
      <div class="game-board">
        <game-board></game-board>
      </div>
    </section>

    <section>
      <div class="game-grid">
        <div class="game-countdown"></div>
        <div class="game-correct-answer"></div>
        <div class="game-choice"></div>
        <div class="game-questions"></div>
      </div>
  </section>

  <section>
    <div class="player-input-wrapper">   
        
        <div class="player-status"></div>
        <div class="player-marks"></div>
        <game-betting-slider></game-betting-slider>
        <div class="player-input">  
            <div><button class="js-player-bet">Betta</button></div>
            <div><button class="js-player-pass">Passa</button></div>
            <div><button class="js-player-fold">Lägga sig</button></div>
        </div>
      </div> 
  </section>


<!-- this only for development to easier see were things are. Remove at production -->
<section>
  <div class="game-descript" style="background-color: #444; padding: var(--standard-padding); line-height: 1.7; margin-top: 6rem; font-weight: 700">
    <ul>
      <li style="color: #DCF7F3">- Countdown-timer. Css-class: .game-countdown.</li>
      <li style="color: #FFFCDD">- Correct answer. Css-class: .game-correct-answer.</li>
      <li style="color: #FFD8D8">- Player choice, Css-class: .game-choice.</li>
      <li style="color: #e3ffdd">- Questions. Css-class: .game-questions.</li>
    </ul>
  </div>
</section>

  </main>
</body>


<script type="module">
  import {questions} from './modules/questions.js';
  import {createQuestionForm} from './modules/template.js';
  import {countDown} from './modules/countdown.js';
  import {playerChoice} from './modules/playerchoice.js';
  import {players} from './modules/players.js';
  import {seatPlayer} from './modules/seatplayer.js';
  import {bettingSlider} from './modules/bettingslider.js';
  import {createGameBoard} from './modules/gameboard.js';
  
  
  var currentPlayer = players.player1;
  var player = currentPlayer; // remove this, only for see if old code works (bet, fold etc)
  
  window.onload = gameEngine();
    
  function gameEngine(currentRound = 1, questionNumber = 1) {
    let currentQuestion = questions[`question${questionNumber}`];
   

    createQuestionForm(currentQuestion);
    countDown(4, currentQuestion);
    createGameBoard(players);

    let form = document.querySelector('#game-form');
    let radios = form.elements['questions'];
    form.addEventListener('change', function() {playerChoice(radios)});

    let elementBet = document.querySelector('.js-player-bet');
    elementBet.addEventListener('click', bet);

    let elementPass = document.querySelector('.js-player-pass');
    elementPass.addEventListener('click', pass);

    let elementFold = document.querySelector('.js-player-fold');
    elementFold.addEventListener('click', fold);

    function bet() {
      console.log('bet running');
      let slider = document.querySelector("game-betting-slider");
      let sliderValue = slider.shadowRoot.querySelector(".bet-slider-output").value;
      player.marks = player.marks - sliderValue;
      let playerMarks = document.querySelector('.player-marks');
      playerMarks.innerHTML = `Du har ${player.marks} marker`;
  };

  function pass() {
    console.log('pass running');
    player.pass = true;
    let playerStatus = document.querySelector('.player-status');
    playerStatus.innerHTML = `Passat är: <i>${player.pass}</i>. Lagt är: <i>${player.fold}</i>.`;
  };

  function fold() {
    console.log('fold running');
    player.fold = true;
    let playerStatus = document.querySelector('.player-status');
    playerStatus.innerHTML = `Passat är: <i>${player.pass}</i>. Lagt är: <i>${player.fold}</i>.`;
  };


    function currentPlayerInfo(currentPlayer) {
      let player = currentPlayer;
      var statusOutput = `Passat är: <i>${player.pass}</i>. Lagt är: <i>${player.fold}</i>.`
      let playerMarks = document.querySelector('.player-marks');
      playerMarks.innerHTML = `Du har ${player.marks} marker`;
      let playerStatus = document.querySelector('.player-status');
      playerStatus.innerHTML = `Passat är: <i>${player.pass}</i>. Lagt är: <i>${player.fold}</i>.`;
      console.log('current player', player);
    };
    currentPlayerInfo(currentPlayer);

    

    
  };

</script>


<script>

//Old code, remove later

  
  

  function bet() {
    let slider = document.querySelector("game-betting-slider");
    let sliderValue = slider.shadowRoot.querySelector(".bet-slider-output").value;
    player.marks = player.marks - sliderValue;
    let playerMarks = document.querySelector('.player-marks');
    playerMarks.innerHTML = `Du har ${player.marks} marker`;
  };

  function pass() {
    player.pass = true;
    let playerStatus = document.querySelector('.player-status');
    playerStatus.innerHTML = `Passat är: <i>${player.pass}</i>. Lagt är: <i>${player.fold}</i>.`;
  };

  function fold() {
    player.fold = true;
    let playerStatus = document.querySelector('.player-status');
    playerStatus.innerHTML = `Passat är: <i>${player.pass}</i>. Lagt är: <i>${player.fold}</i>.`;
  };

  


</script>


</html>
